<div class="overlay" *ngIf="loadingFlag">
    <div class="spinner-border text-secondary spinner-wrapper" role="status" style="width: 3rem; height: 3rem;">
        <div><i class="fa fa-circle-o-notch fa-spin"></i></div>
    </div>
</div>
<div class="content-wrapper">
    <div *ngIf="campuses" class="main-content">
        <div class="row">
            <div class="col-12">

                <div style="float: left">
                    <div style="color: #595F69; font-size: 23px; margin-bottom: 17px">Quản lý phòng</div>
                </div>
                <div style="clear: both"></div>
                <!-- START TABS -->
                <div>
                    <div>
                        <div class="tab-option clickable" [ngClass]="{ 'num-active': campusIndex == 0 }"
                            (click)="getAllRegisterRoom(0, 'all')">
                            Tất cả
                        </div>

                        <div *ngFor="let campus of campuses; let i = index" class="tab-option clickable"
                            [ngClass]="{ 'num-active': campusIndex == i + 1 }"
                            (click)="getAllRegisterRoom(i + 1, campus.name)">
                            {{campus.name}}
                        </div>
                    </div>

                    <hr style="margin-top: 0" />

                    <div style="height: 10px"></div>
                </div>
                <!-- END TABS -->
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <div class="input-group">
                            <input type="text" value="" [(ngModel)]="searchText" class="form-control search-input"
                                (keydown.enter)="onSearch()"
                                placeholder="Tìm kiếm theo tên phòng hoặc tên sinh viên hoặc mã sinh viên" />
                            <img class="btn-search-remaining-rooms" (click)="onSearch()"
                                src="../../assets/images/search_icon.png" title="Search" width="20" />
                        </div>
                        <div class="table-responsive table-rooms">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Id</th>
                                        <th>Tên phòng</th>
                                        <th>Loại phòng</th>
                                        <th>Tên sinh viên</th>
                                        <th>Mã số sinh viên</th>
                                        <th>Khu nhà</th>
                                        <th></th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let registerRoom of registerRoomList">
                                        <td>{{registerRoom.id}}</td>
                                        <td>
                                            {{registerRoom.roomName}}
                                        </td>
                                        <td>{{registerRoom.typeRoomName}}</td>

                                        <td>{{registerRoom.studentName}}</td>

                                        <td>{{registerRoom.idCard}}</td>

                                        <td>{{registerRoom.campusName}}</td>
                                        <td>
                                            <i class="icon-edit mdi mdi-24px mdi-pencil-outline"
                                                (click)="openModalInfo(modalRegisterRoom, registerRoom)"></i>
                                        </td>

                                        <td>
                                            <i class="icon-edit mdi mdi-24px mdi-delete-outline"
                                                (click)="deleteRegisterRoom(registerRoom)"></i>
                                        </td>
                                    </tr>
                                    <tr *ngIf="registerRoomTotal == 0">
                                        <td colspan="9" class="no-data">Không có dữ liệu.</td>
                                    </tr>

                                </tbody>
                            </table>
                            <div class="tbl-checkins-paging">
                                <div *ngIf="registerRoomTotal != 0" class="row">
                                    <div class="col-xs-12 col-md-6">
                                        <select [(ngModel)]="pageSize" (change)="resetPage()" style="padding: 11px;
                                    padding-left: 9px;
                                    border: 1px solid #898E93;
                                    border-radius: 16px;
                                    background: white;">
                                            <option>10</option>
                                            <option>25</option>
                                            <option>50</option>
                                        </select>
                                        <div
                                            style="display: inline; color: #8a9099; margin-left: 10px; font-size: 15px; line-height: 22px">
                                            Kết quả mỗi trang</div>
                                    </div>

                                    <div class="col-xs-12 col-md-6">

                                        <div class="custom-paging-wrapper">
                                            <ngb-pagination id="page" [collectionSize]="registerRoomTotal"
                                                [(page)]="page" [maxSize]="5" [pageSize]="pageSize"
                                                (pageChange)="changePage($event)" [boundaryLinks]="true">
                                                <ng-template ngbPaginationFirst><i class="mdi mdi-chevron-double-left"
                                                        aria-hidden="true"></i>
                                                </ng-template>
                                                <ng-template ngbPaginationLast><i class="mdi mdi-chevron-double-right"
                                                        aria-hidden="true"></i>
                                                </ng-template>
                                                <ng-template ngbPaginationPrevious>Trước</ng-template>
                                                <ng-template ngbPaginationNext>Sau</ng-template>
                                                <ng-template ngbPaginationEllipsis>...</ng-template>
                                            </ngb-pagination>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <ng-template #modalRegisterRoom let-modal class="modal fade" id="modalDetailARemainingRoom"
        aria-labelledby="modalDetailARemainingRoomLabel">
        <div class="modal-content">
            <div class="modal-header">
                <img class="icon-bill-small" src="../../assets/images/room.svg" style="margin-right: 20px;" />
                <h3 class="modal-title" id="modalDetailARemainingRoomLabel">THÔNG TIN ĐỀ NGHỊ THUÊ PHÒNG</h3>
                <button type="button" class="close" (click)="modal.dismiss()" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="section-info">
                    <div class="row">
                        <div class="col-xs-6 col-md-1"></div>
                        <div class="col-xs-6 col-md-3">
                            <img class="icon-bill" src="../../assets/images/room.svg" style="margin-bottom: 15px;" />
                        </div>
                        <div class="col-xs-6 col-md-2"></div>
                        <div *ngIf="modalRegisterRoomPayment.registerRoomDto" class="col-xs-6 col-md-6">

                            <div class="row">
                                <div class="col-xs-6 col-md-6 col-title">MÃ SỐ SINH VIÊN
                                </div>
                                <div class="col-xs-6 col-md-6">
                                    {{ modalRegisterRoomPayment.registerRoomDto.idCard}}
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-xs-6 col-md-6 col-title">TÊN SINH VIÊN
                                </div>
                                <div class="col-xs-6 col-md-6">
                                    {{ modalRegisterRoomPayment.registerRoomDto.studentName}}
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-xs-6 col-md-6 col-title">TÊN PHÒNG
                                </div>
                                <div class="col-xs-6 col-md-6">
                                    {{ modalRegisterRoomPayment.registerRoomDto.roomName}}
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-xs-6 col-md-6 col-title">LOẠI PHÒNG
                                </div>
                                <div class="col-xs-6 col-md-6">
                                    {{ modalRegisterRoomPayment.registerRoomDto.typeRoomName}}
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-xs-6 col-md-6 col-title">TIỀN PHÒNG PHẢI TRẢ
                                </div>
                                <div class="col-xs-6 col-md-6">
                                    {{ modalRegisterRoomPayment.infoMoneyDto.moneyOfRoomMustPay | positiveNumber | number}}
                                    đ
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-xs-6 col-md-6 col-title">TIỀN NƯỚC PHẢI TRẢ
                                </div>
                                <div class="col-xs-6 col-md-6">
                                    {{ modalRegisterRoomPayment.infoMoneyDto.moneyOfWaterMustPay | positiveNumber | number}}
                                    đ
                                </div>
                            </div>

                            <div class="row justify-content-end">
                                <button type="button" class="btn btn-success" (click)="saveRegister()">Lưu</button>
                                <button type="button" class="btn btn-light" (click)="modal.close()">Hủy</button>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>
</div>